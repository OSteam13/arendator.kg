<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Arendator.kg — свежие квартиры без посредников</title>
  <meta name="description" content="Свежие объявления аренды от владельцев. Анти-агент фильтр, контакты — в Telegram." />
  <link rel="icon" href="./images/Arendatorkg.png">
  <link href="https://fonts.googleapis.com/css2?family=Onest:wght@400;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{--container:1180px}

    /* ===== Reset ===== */
    *,*::before,*::after{box-sizing:border-box}
    html{-webkit-text-size-adjust:100%}
    img,svg,video{max-width:100%;height:auto;display:block}
    a,button{min-width:0}

    .container{max-width:var(--container)}
    .shadow-soft{box-shadow:0 8px 30px rgba(0,0,0,.08)}
    html,body{overflow-x:hidden;font-family:'Onest',system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;font-weight:400}
    .hero-title{font-weight:800}
    .lang-toggle{padding:.25rem .5rem;border:1px solid rgb(229 231 235);border-radius:.75rem}
    .lang-toggle span{opacity:.55}
    .lang-toggle .active{opacity:1;font-weight:700}
    .tg-ico{display:inline-flex;align-items:center;margin-right:.5rem}
    .tg-ico svg{width:18px;height:18px}

    /* разноцветные точки */
    .dot{width:8px;height:8px;border-radius:9999px;display:inline-block}
    .dot.pulse{animation:pulse 1.6s infinite}
    .dot + .dot{margin-left:6px}
    @keyframes pulse{0%,100%{transform:scale(1);opacity:.8}50%{transform:scale(1.25);opacity:1}}

    /* карточки объявлений */
    .ads-wrap { margin: 24px auto; max-width: var(--container); padding: 0 16px; }
    .ads-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 16px; }

    .ad-card {
      position:relative; border: 1px solid #eee; border-radius: 14px; overflow: hidden; background: #fff;
      box-shadow: 0 2px 10px rgba(0,0,0,.03); display: flex; flex-direction: column;
      height:480px;
    }

    .ad-thumb { aspect-ratio: 4 / 3; background: #f6f7f8; overflow: hidden; }
    .ad-thumb img { width: 100%; height: 100%; object-fit: cover; display: block; }

    .ad-body {
      position:relative; padding: 12px 14px 70px; display: flex; flex-direction: column; gap: 8px; flex:1;
    }
    .ad-title { font: 600 16px/1.3 system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden }
    .ad-price { color: #0d6efd; font-weight: 700; }
    .ad-meta { color: #666; font-size: 13px; display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden }

    .ad-cta { position:absolute; left:14px; right:14px; bottom:56px; height:44px; border-radius:8px;
      display:grid; place-items:center; text-decoration:none; background:#0d6efd; color:#fff; font-weight:700 }

    .ad-fav { position:absolute; right:18px; bottom:10px; background:none; border:none; padding:0; cursor:pointer;
      font-size:13px; color:#3f3f46; }
    .ad-fav .heart{color:#e11d48;margin-left:6px}
    .ad-fav.active{color:#e11d48;font-weight:600}

    .ads-empty { text-align: center; color: #666; padding: 24px 0; }

    /* Плашка героя (правая колонка) */
    #heroSpot { display:flex; flex-direction:column; height:100%; background:#f5f6f7 }
    #heroSpot .spot-img{ height:260px; display:flex; align-items:center; justify-content:center; overflow:hidden; background:#f1f5f9 }
    @media (min-width:1024px){ #heroSpot .spot-img{ height:300px } }
    #heroSpot .spot-img img{ width:100%; height:100%; object-fit:cover }
    #heroSpot .spot-body{ position:relative; padding:12px 12px 72px; border-top:1px solid #e5e7eb; background:#fff; display:flex; flex-direction:column; gap:6px }
    #heroSpot .spot-title{ font-weight:600; line-height:1.25; display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden }
    #heroSpot .spot-price{ color:#0d6efd; font-weight:800 }
    #heroSpot .spot-cta{ position:absolute; left:12px; right:12px; bottom:12px; height:44px; border-radius:8px;
      display:grid; place-items:center; background:#0d6efd; color:#fff; text-decoration:none; font-weight:700 }
    #heroSpot .spot-fav{ position:absolute; right:16px; bottom:62px; background:none; border:none; padding:0; cursor:pointer; font-size:13px; color:#3f3f46 }
    #heroSpot .spot-fav .heart{color:#e11d48;margin-left:6px}
    #heroSpot .spot-fav.active{color:#e11d48;font-weight:600}

    .ph-wrap{display:flex;align-items:center;justify-content:center; width:100%; height:100%; color:#9aa1ab}
    .ph-wrap svg{width:64px;height:64px;opacity:.7}
    .ph-text{font-size:12px;color:#818b98;margin-top:6px}

    .hero-card{overflow:visible}
    .hero-card *{min-width:0}
    .hero-card{word-wrap:break-word;overflow-wrap:anywhere}
    #heroTitle{font-size:clamp(22px,6.5vw,48px); line-height:1.15}
    #heroLead{font-size:clamp(14px,4.2vw,18px)}
    #btnTelegram,#btnSeeOnSite{ padding:clamp(10px,3vw,12px) clamp(14px,4vw,20px); font-size:clamp(14px,4vw,16px); }
    #heroActions{display:flex; flex-wrap:wrap; gap:.5rem}
    #heroActions a{flex:1 1 100%; min-width:0}
    #heroBadges{flex-wrap:wrap; gap:.25rem .75rem}
    #heroSocial{flex-wrap:wrap; gap:.5rem 1rem}
    #heroSpot .spot-img{height:clamp(180px,42vw,300px)}

    @media (max-width:360px){
      .hero-card{padding:12px !important}
      #heroTitle{font-size:clamp(20px,7vw,26px)}
      #heroLead{font-size:13px}
      #heroSpot .spot-body{padding:10px 10px 68px}
      #heroSpot .spot-cta{height:40px}
    }
  </style>
</head>
<body class="bg-neutral-50 text-neutral-900">

  <!-- Верхняя полоса -->
  <div id="topline" class="bg-emerald-600 text-white text-center text-xs sm:text-sm py-2" data-i18n="topline">
    Объявления живут 24 часа · Анти-агент фильтр включён · Контакты — в Telegram
  </div>

  <!-- Хедер -->
  <header class="bg-white sticky top-0 z-30 border-b border-neutral-100/80">
    <div class="container mx-auto px-4 py-2 md:py-2">
      <div class="flex flex-wrap items-center gap-3">
        <a href="/" class="order-1 flex items-center gap-2 shrink-0">
          <img src="./images/Arendatorkg.png" alt="Arendator.kg" class="w-8 h-8 rounded-full object-contain">
        </a>

        <nav class="order-3 w-full mt-1 grid grid-cols-3 gap-2 text-sm
                    md:order-2 md:w-auto md:mt-0 md:grid-cols-none md:flex md:flex-1 md:justify-center md:gap-3">
          <a id="navBlog" href="blog.html"
             class="w-full h-9 px-3 rounded-xl border border-neutral-200 hover:bg-neutral-50 flex items-center justify-center text-center"
             data-i18n="nav_blog">Блог</a>
          <a id="navPost" href="https://t.me/ArendatorKG_Post_Bot" target="_blank" rel="noopener"
             class="w-full h-9 px-3 rounded-xl bg-neutral-900 text-white hover:bg-neutral-800 flex items-center justify-center text-center"
             data-i18n="nav_add">Добавить объявление</a>
          <a id="navFav" href="favorites.html"
             class="w-full h-9 px-3 rounded-xl border border-neutral-200 hover:bg-neutral-50 flex items-center justify-center text-center"
             data-i18n="nav_fav">Избранное</a>
        </nav>

        <!-- Переключатель языка -->
        <button id="langBtn" class="order-2 md:order-3 ml-auto lang-toggle text-sm" type="button">
          <span id="langRU" class="active">Рус</span> / <span id="langKY">Кыр</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Герой -->
  <section class="container mx-auto px-4 pt-6 pb-4">
    <div class="hero-card rounded-2xl bg-white border border-neutral-200 shadow-soft p-4 md:p-6 grid md:grid-cols-2 gap-4 items-start">
      <div>
        <h1 id="heroTitle" class="hero-title text-blue-600" data-i18n="hero_title">
          Ищете квартиру в аренду?
        </h1>
        <p id="heroLead" class="mt-2 text-neutral-600" data-i18n="hero_lead">
          Экономьте время и нервы: мы находим «живые» объявления, отсекаем посредников, выдаём контакты в Telegram — без спама и лишних звонков.
        </p>

        <!-- Кнопки -->
        <div id="heroActions" class="mt-4">
          <a id="btnTelegram"
             class="box-border px-5 py-3 rounded-xl bg-blue-600 text-white hover:bg-blue-700 inline-flex items-center justify-center"
             href="https://t.me/arendatorkg" target="_blank" rel="noopener" data-i18n="btn_open_tg">
            <span class="tg-ico" aria-hidden="true">
              <svg viewBox="0 0 24 24" fill="currentColor"><path d="M9.999 15.2 9.9 19c.4 0 .6-.2.8-.4l1.9-1.8 4.1 3c.8.4 1.4.2 1.6-.8l2.9-13.5c.3-1.3-.5-1.8-1.3-1.5L2.5 9.4c-1.3.5-1.3 1.2-.2 1.5l4.6 1.4L18.9 6c.7-.4 1.3-.2 .8.2"/></svg>
            </span>
            Открыть в Telegram
          </a>
          <a id="btnSeeOnSite"
             class="box-border px-5 py-3 rounded-xl border border-neutral-200 hover:bg-neutral-50 inline-flex items-center justify-center mt-2"
             href="#feed" data-i18n="btn_see_site">Смотреть ленту на сайте</a>
        </div>

        <!-- Бейджи -->
        <div id="heroBadges" class="mt-3 flex items-center gap-4 text-sm text-neutral-600">
          <div id="badgeAnti" class="flex items-center gap-2" data-i18n="badge_anti">
            <span class="dot pulse" style="background:#22c55e"></span>
            <span>Анти-агент фильтр</span>
          </div>
          <div id="badgeLive" class="flex items-center gap-2" data-i18n="badge_live">
            <span class="dot pulse" style="background:#3b82f6;animation-delay:.2s"></span>
            <span class="dot pulse" style="background:#f59e0b;animation-delay:.4s"></span>
            <span>Ежесекундные обновления</span>
          </div>
        </div>

        <!-- Соцссылки -->
        <div id="heroSocial" class="mt-3 flex items-center gap-4 text см">
          <a href="https://t.me/arendatorkg" target="_blank" rel="noopener" class="inline-flex items-center gap-2 hover:opacity-80">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="#229ED9"><path d="M9.9 15.2 9.7 19c.4 0 .6-.2.8-.4l2-1.9 4.2 3c.8.4 1.5.2 1.7-.8l3-13.8c.3-1.3-.6-1.9-1.4-1.6L2.4 9.5c-1.3.5-1.3 1.3-.2 1.6l4.8 1.5 10.9-6.6c.8-.4 1.4-.2.9.3L9.9 15.2z"/></svg>
            <span>Telegram</span>
          </a>
          <a href="https://www.instagram.com/arendatorkg/" target="_blank" rel="noopener" class="inline-flex items-center gap-2 hover:opacity-80">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="#E1306C"><path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm5 5.5A5.5 5.5 0 1 0 17.5 13 5.5 5.5 0 0 0 12 7.5zm0 2A3.5 3.5 0 1 0 15.5 13 3.5 3.5 0 0 0 12 9.5zM18 6.5a1.1 1.1 0 1 1-1.1-1.1A1.1 1.1 0 0 1 18 6.5z"/></svg>
            <span>Instagram</span>
          </a>
          <a href="https://www.threads.com/@arendatorkg" target="_blank" rel="noopener" class="inline-flex items-center gap-2 hover:opacity-80">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="#000"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm4.9 11.2c-.3 1.5-1.8 3.7-4.9 3.7-2.6 0-4.5-1.7-4.5-4.1 0-2.5 2-4.1 4.6-4.1 1.9 0 3.2.8 4 2.1.3.5.5 1 .6 1.6l-1.9.2c-.1-.3-.2-.7-.5-1-.5-.6-1.2-1-2.2-1-1.6 0-2.6 1-2.6 2.2s.9 2.1 2.5 2.1c1.2 0 2-.5 2.4-1.3H12v-1.8h4.8c.1.5.1 1 .1 1.4 0 .3 0 .6-.1 1z"/></svg>
            <span>Threads</span>
          </a>
        </div>
      </div>

      <div id="heroSpot" class="rounded-xl overflow-hidden border border-neutral-200">
        <div class="spot-img"></div>
        <div class="spot-body">
          <div class="spot-title text-sm"></div>
          <div class="spot-price"></div>
          <button class="spot-fav" type="button" data-spot-fav>
            В избранное <span class="heart">❤</span>
          </button>
          <a class="spot-cta" href="https://t.me/arendatorkg" target="_blank" rel="noopener" data-i18n="card_btn">🔑 Получить контакты</a>
        </div>
      </div>
    </div>
  </section>

  <!-- Рекламный слот -->
  <div class="container mx-auto px-4">
    <div class="my-3 rounded-2xl border border-neutral-200 bg-white shadow-soft grid place-items-center min-h-[72px] sm:min-h-[90px]">
      <span class="text-sm text-neutral-500" data-i18n="ad_slot">Место для рекламы (банк · мебель · интернет)</span>
    </div>
  </div>

  <!-- Лента -->
  <main id="feed" class="container mx-auto px-4 pb-6">
    <section class="ads-wrap">
      <h2 id="feedTitle" class="text-2xl font-bold mb-2" data-i18n="feed_title">Свежие объявления</h2>
      <div id="ads" class="ads-grid"></div>
      <div id="ads-empty" class="ads-empty" hidden data-i18n="feed_empty">Объявлений пока нет</div>
      <div class="flex justify-center mt-2">
        <button id="loadMore" class="px-4 py-2 rounded-xl border border-neutral-300 hover:bg-neutral-50" data-i18n="show_more">
          Показать ещё
        </button>
      </div>
    </section>
  </main>

  <!-- Тарифы -->
  <section class="container mx-auto px-4 pb-8">
    <h2 id="plansTitle" class="text-2xl font-bold mb-1" data-i18n="plans_title">Доступ к контактам</h2>
    <p id="plansLead" class="text-neutral-700 mb-4" data-i18n="plans_lead">
      Лучшие варианты улетают за часы. Подключите доступ — бот пришлёт контакты владельцев.
    </p>

    <div class="grid md:grid-cols-3 gap-3">
      <div class="rounded-2xl border border-neutral-200 bg-white p-4 shadow-soft">
        <div class="text-xl font-bold mb-1">150 сом — 1 день</div>
        <ul class="space-y-1 text-neutral-700 text-sm mb-3">
          <li>• Контакты владельцев без лимита</li>
          <li>• Анти-агент фильтр</li>
          <li>• Уведомления о новых совпадениях</li>
        </ul>
        <a class="box-border w-full sm:w-auto px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 inline-flex items-center"
           href="https://t.me/arendatorkg" target="_blank" rel="noopener">
          <span class="tg-ico" aria-hidden="true">
            <!-- тот же валидный путь, что сверху -->
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M9.999 15.2 9.9 19c.4 0 .6-.2.8-.4l1.9-1.8 4.1 3c.8.4 1.4.2 1.6-.8l2.9-13.5c.3-1.3-.5-1.8-1.3-1.5L2.5 9.4c-1.3.5-1.3 1.2-.2 1.5l4.6 1.4L18.9 6c.7-.4 1.3-.2 .8.2"/></svg>
          </span>
          Получить в Telegram
        </a>
      </div>

      <div class="rounded-2xl border border-neutral-200 bg-white p-4 shadow-soft">
        <div class="text-xl font-bold mb-1">300 сом — 5 дней</div>
        <ul class="space-y-1 text-neutral-700 текст-sm mb-3">
          <li>• Контакты владельцев без лимита</li>
          <li>• Анти-агент фильтр</li>
          <li>• Уведомления о новых совпадениях</li>
        </ul>
        <a class="box-border w_full sm:w-auto px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 inline-flex items-center"
           href="https://t.me/arendatorkg" target="_blank" rel="noopener">
          <span class="tg-ico" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M9.999 15.2 9.9 19c.4 0 .6-.2.8-.4l1.9-1.8 4.1 3c.8.4 1.4.2 1.6-.8l2.9-13.5c.3-1.3-.5-1.8-1.3-1.5L2.5 9.4c-1.3.5-1.3 1.2-.2 1.5l4.6 1.4L18.9 6c.7-.4 1.3-.2 .8.2"/></svg>
          </span>
          Получить в Telegram
        </a>
      </div>

      <div class="rounded-2xl border border-neutral-200 bg-white p-4 shadow-soft">
        <div class="text-xl font-bold mb-1">600 сом — 20 дней</div>
        <ul class="space-y-1 text-neutral-700 text-sm mb-3">
          <li>• Контакты владельцев без лимита</li>
          <li>• Анти-агент фильтр</li>
          <li>• Уведомления о новых совпадениях</li>
        </ul>
        <a class="box-border w-full sm:w-auto px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 inline-flex items-center"
           href="https://t.me/arendatorkg" target="_blank" rel="noopener">
          <span class="tg-ico" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M9.999 15.2 9.9 19c.4 0 .6-.2.8-.4l1.9-1.8 4.1 3c.8.4 1.4.2 1.6-.8l2.9-13.5c.3-1.3-.5-1.8-1.3-1.5L2.5 9.4c-1.3.5-1.3 1.2-.2 1.5l4.6 1.4L18.9 6c.7-.4 1.3-.2 .8.2"/></svg>
          </span>
          Получить в Telegram
        </a>
      </div>
    </div>
  </section>

  <!-- Соцсети -->
  <section class="container mx-auto px-4 pb-10">
    <div class="rounded-2xl border border-neutral-200 bg-white shadow-soft p-6 text-center">
      <div class="text-xl font-bold mb-4">МЫ ЕСТЬ В СОЦ СЕТЯХ</div>
      <div class="flex items-center justify-center gap-6">
        <a href="https://t.me/arendatorkg" target="_blank" rel="noopener" aria-label="Telegram" class="hover:opacity-80">
          <svg width="36" height="36" viewBox="0 0 24 24" fill="#229ED9"><path d="M9.9 15.2 9.7 19c.4 0 .6-.2.8-.4l2-1.9 4.2 3c.8.4 1.5.2 1.7-.8l3-13.8c.3-1.3-.6-1.9-1.4-1.6L2.4 9.5c-1.3.5-1.3 1.3-.2 1.6l4.8 1.5 10.9-6.6c.8-.4 1.4-.2.9.3L9.9 15.2z"/></svg>
        </a>
        <a href="https://www.instagram.com/arendatorkg/" target="_blank" rel="noopener" aria-label="Instagram" class="hover:opacity-80">
          <svg width="36" height="36" viewBox="0 0 24 24" fill="#E1306C"><path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm0 2a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V7a3 3 0 0 0-3-3H7zm5 3.5A5.5 5.5 0 1 1 6.5 13 5.5 5.5 0 0 1 12 7.5zm0 2A3.5 3.5 0 1 0 15.5 13 3.5 3.5 0 0 0 12 9.5zM18 6.5a1.1 1.1 0 1 1-1.1-1.1A1.1 1.1 0 0 1 18 6.5z"/></svg>
        </a>
        <a href="https://www.threads.com/@arendatorkg" target="_blank" rel="noopener" aria-label="Threads" class="hover:opacity-80">
          <svg width="36" height="36" viewBox="0 0 24 24" fill="#000"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm4.9 11.2c-.3 1.5-1.8 3.7-4.9 3.7-2.6 0-4.5-1.7-4.5-4.1 0-2.5 2-4.1 4.6-4.1 1.9 0 3.2.8 4 2.1.3.5.5 1 .6 1.6l-1.9.2c-.1-.3-.2-.7-.5-1-.5-.6-1.2-1-2.2-1-1.6 0-2.6 1-2.6 2.2s.9 2.1 2.5 2.1c1.2 0 2-.5 2.4-1.3H12в-1.8h4.8c.1.5.1 1 .1 1.4 0 .3 0 .6-.1 1z"/></svg>
        </a>
      </div>
    </div>
  </section>

  <!-- Футер -->
  <footer class="border-t border-neutral-100 bg-white">
    <div class="container mx-auto px-4 py-6 grid md:grid-cols-4 gap-4 текст-sm">
      <div class="md:col-span-2">
        <div class="flex items-center gap-2">
          <img src="./images/Arendatorkg.png" alt="Arendator.kg" class="w-7 h-7 rounded-full object-contain">
          <span class="font-semibold">Arendator.kg</span>
        </div>
        <p id="footerLead" class="text-neutral-600 mt-2 max-w-[60ch]" data-i18n="footer_lead">
          Автоматически мониторим свежие объявления от владельцев и проверенных источников, чтобы вы нашли жильё быстрее и без посредников.
        </p>
      </div>
      <div>
        <div class="font-semibold" data-i18n="footer_nav">Навигация</div>
        <ul class="mt-2 space-y-1 text-neutral-600">
          <li><a href="https://t.me/ArendatorKG_Post_Bot" target="_blank" rel="noopener" class="hover:text-blue-600" data-i18n="nav_add">Добавить объявление</a></li>
          <li><a href="blog.html" class="hover:text-blue-600" data-i18n="nav_blog">Блог</a></li>
        </ul>
      </div>
      <div>
        <div class="font-semibold" data-i18n="footer_legal">Правовое</div>
        <ul class="mt-2 space-y-1 text-neutral-600">
          <li><a class="hover:text-blue-600" href="data-deletion.html" data-i18n="footer_delete">Удаление данных</a></li>
          <li><a class="hover:text-blue-600" href="#" data-i18n="footer_privacy">Политика конфиденциальности</a></li>
        </ul>
      </div>
    </div>
    <div class="text-center text-xs text-neutral-500 pb-5">© 2025 — Arendator.kg</div>
  </footer>

  <!-- === Скрипт: язык + объявления + избранное === -->
  <script>
    /* ======================= I18N ======================= */
    const I18N = {
      ru: { topline:'Объявления живут 24 часа · Анти-агент фильтр включён · Контакты — в Telegram',
        nav_blog:'Блог', nav_add:'Добавить объявление', nav_fav:'Избранное',
        hero_title:'Ищете квартиру в аренду?',
        hero_lead:'Экономьте время и нервы: мы находим «живые» объявления, отсекаем посредников, выдаём контакты в Telegram — без спама и лишних звонков.',
        btn_open_tg:'Открыть в Telegram', btn_see_site:'Смотреть ленту на сайте',
        badge_anti:'Анти-агент фильтр', badge_live:'Ежесекундные обновления',
        ad_slot:'Место для рекламы (банк · мебель · интернет)',
        feed_title:'Свежие объявления', feed_empty:'Объявлений пока нет',
        plans_title:'Доступ к контактам',
        plans_lead:'Лучшие варианты улетают за часы. Подключите доступ — бот пришлёт контакты владельцев.',
        plan_week:'300 сом — Неделя', plan_month:'600 сом — Месяц',
        p1:'• Контакты владельцев без лимита', p2:'• Анти-агент фильтр', p3:'• Уведомления о новых совпадениях',
        btn_get_tg:'Получить в Telegram',
        footer_lead:'Автоматически мониторим свежие объявления от владельцев и проверенных источников, чтобы вы нашли жильё быстрее и без посредников.',
        footer_nav:'Навигация', footer_legal:'Правовое', footer_delete:'Удаление данных', footer_privacy:'Политика конфиденциальности',
        card_btn:'🔑 Получить контакты', card_no_district:'Район не указан',
        price_contract:'Договорная', currency:' сом',
        no_photo:'Фото не предоставлено', show_more:'Показать ещё',
        fav_add:'В избранное', fav_remove:'В избранном'
      },
      ky: { topline:'Жарыялар 24 саат жарактуу · Агенттерге каршы фильтр күйгүзүлгөн · Байланыш — Telegram\'да',
        nav_blog:'Блог', nav_add:'Жарнама кошуу', nav_fav:'Тандалгандар',
        hero_title:'Батир издеп жатасыңбы?',
        hero_lead:'Биз «жандуу» жарыяларды таап, ортомчуларды бөлүп чыгарабыз, байланыштарды Telegram аркылуу беребиз — спамсыз жана ашыкча чалуусуз.',
        btn_open_tg:'Telegram\'да ачуу', btn_see_site:'Лентаны сайттан көрүү',
        badge_anti:'Агент фильтри', badge_live:'Секунд сайын жаңыланат',
        ad_slot:'Жарнама үчүн орун (банк · эмерек · интернет)',
        feed_title:'Жаңы жарыялар', feed_empty:'Азырынча жарыялар жок',
        plans_title:'Байланыштарга жетүү',
        plans_lead:'Эң мыкты варианттар бир нече саатта эле кетет. Жеткиликтүү кыл — бот ээнин контакттарын жөнөтөт.',
        plan_week:'300 сом — Жума', plan_month:'600 сом — Ай',
        p1:'• Ээлердин байланыштары чексиз', p2:'• Агент фильтри', p3:'• Жаңы дал келиштер тууралуу билдирүүлөр',
        btn_get_tg:'Telegram аркылуу алуу',
        footer_lead:'Биз текшерилген булактардан жана ээлерден жаңы жарыяларды көзөмөлдөп турабыз — батирди ортомчусуз тез тап.',
        footer_nav:'Навигация', footer_legal:'Юридикалык', footer_delete:'Маалыматтарды өчүрүү', footer_privacy:'Купуялык саясаты',
        card_btn:'🔑 Байланышты алуу', card_no_district:'Району көрсөтүлгөн эмес',
        price_contract:'Макулдашылат', currency:' сом',
        no_photo:'Сүрөт берилген эмес', show_more:'Дагы көрсөтүү',
        fav_add:'Тандалууга', fav_remove:'Тандалууда'
      }
    };

    function getLang(){ return localStorage.getItem('lang') || (document.documentElement.lang || 'ru'); }
    function setLang(l){
      localStorage.setItem('lang', l);
      document.documentElement.lang = l;
      document.getElementById('langRU').classList.toggle('active', l==='ru');
      document.getElementById('langKY').classList.toggle('active', l==='ky');
      document.querySelectorAll('[data-i18n]').forEach(el=>{
        const k=el.getAttribute('data-i18n'), v=(I18N[l]&&I18N[l][k])||(I18N.ru[k]||'');
        if(v) el.textContent=v;
      });
      const lm=document.getElementById('loadMore'); if(lm) lm.textContent = I18N[l].show_more;
      if(window.__allRendered) refreshFavLabels();
    }
    document.getElementById('langBtn').addEventListener('click',()=>setLang(getLang()==='ru'?'ky':'ru'));

    /* ======================= API (Supabase REST) ======================= */
    const API_LIMIT = 24;
    const POLL_MS = 60_000;
    const BOT_LINK = 'https://t.me/arendatorkg';

    // ⬇⬇⬇ ВСТАВЬ СВОИ ЗНАЧЕНИЯ из Supabase → Project Settings → API
    const SUPABASE_URL  = 'https://oirtcrnhbbuvjfgnjxsp.supabase.co';
    const SUPABASE_ANON = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9pcnRjcm5oYmJ1dmpmZ25qeHNwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2NTYzMDcsImV4cCI6MjA3MjIzMjMwN30.-s4QSiDkT8LEZE0S48oHDUV56crcyAuUO4VVYoeW-7c';
    // ⬆⬆⬆

    const API_URL = (from=0, limit=API_LIMIT) =>
      `${SUPABASE_URL}/rest/v1/listings`
      + `?select=id,title,price,price_text,district,photos,created_at`
      + `&approved=eq.true`
      + `&order=created_at.desc`
      + `&offset=${from}&limit=${limit}`;

    async function fetchPage(from){
      const res = await fetch(API_URL(from, API_LIMIT), {
        headers: { apikey: SUPABASE_ANON, Authorization: `Bearer ${SUPABASE_ANON}` },
        cache: 'no-store'
      });
      if(!res.ok) throw new Error(res.status+' '+res.statusText);
      const rows = await res.json();
      return rows.map(r => ({
        id: r.id,
        title: r.title,
        price: r.price,
        price_text: r.price_text,
        district: r.district,
        photos: r.photos,        // jsonb[]
        createdAt: r.created_at
      }));
    }

    /* ======================= Избранное ======================= */
    const FAV_KEY='arendator:favs';
    function readFav(){ try{ return new Set(JSON.parse(localStorage.getItem(FAV_KEY)||'[]')); }catch{ return new Set(); } }
    function writeFav(set){ localStorage.setItem(FAV_KEY, JSON.stringify([...set])); }
    let favSet = readFav();
    function toggleFav(id){ if(favSet.has(id)) favSet.delete(id); else favSet.add(id); writeFav(favSet); refreshFavButtons(); }
    function isFav(id){ return favSet.has(id); }

    /* ======================= Утилиты и рендер ======================= */
    let listFrom=0, allItems=[];
    const escapeHtml=s=>String(s||'').replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
    const isDefaultPic=url=>url && /default-?ad-?pic\.jpg/i.test(url);
    function fmtPrice(value, price_text){
      const lang=getLang();
      const v = (value ?? price_text);
      if(v===null||v===undefined||v==='') return I18N[lang].price_contract;
      const n=Number(v);
      return isFinite(n)? n.toLocaleString(lang==='ru'?'ru-RU':'ky-KG')+I18N[lang].currency : escapeHtml(String(v));
    }
    function getPhotos(raw){
      if(!raw) return [];
      if(Array.isArray(raw)) return raw;
      if(typeof raw==='string'){
        try{ const v=JSON.parse(raw); return Array.isArray(v)?v:[]; }catch{return [];}
      }
      return [];
    }
    function placeholderHtml(){
      const lang=getLang();
      return `<div class="ph-wrap" role="img" aria-label="${I18N[lang].no_photo}">
        <div class="flex flex-col items-center">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M21 19V7a2 2 0 0 0-2-2h-3.2l-.6-1.2A2 2 0  0 0 13.4 2h-2.8a2 2 0 0 0-1.8 1.2L8.2 5H5a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2ZM7 11l3 4 2-3 3 5H7Z"/></svg>
          <div class="ph-text">${I18N[lang].no_photo}</div>
        </div></div>`;
    }

    function favButtonHtml(id){
      const active=isFav(id);
      return `<button class="ad-fav ${active?'active':''}" type="button" data-fav="${id}">
        В избранное <span class="heart">❤</span>
      </button>`;
    }
    function refreshFavButtons(){
      document.querySelectorAll('[data-fav]').forEach(btn=>{
        const id=btn.getAttribute('data-fav');
        const active=isFav(id);
        btn.classList.toggle('active',active);
      });
      const spotBtn=document.querySelector('[data-spot-fav]');
      if(spotBtn && spotBtn.dataset.id){
        const active=isFav(spotBtn.dataset.id);
        spotBtn.classList.toggle('active',active);
      }
      window.__allRendered = true;
    }
    function refreshFavLabels(){}

    function renderSpot(item){
      const spot=document.getElementById('heroSpot');
      const imgWrap=spot.querySelector('.spot-img');
      const body=spot.querySelector('.spot-body');
      const photos=getPhotos(item.photos);
      const img=photos[0];
      imgWrap.innerHTML='';
      if(img && !isDefaultPic(img)){
        const im=new Image(); im.alt=(item.title||''); im.src=img; imgWrap.appendChild(im);
      }else{ imgWrap.innerHTML=placeholderHtml(); }
      body.querySelector('.spot-title').textContent=item.title||'';
      body.querySelector('.spot-price').textContent=fmtPrice(item.price, item.price_text);

      let favBtn=spot.querySelector('[data-spot-fav]');
      if(!favBtn){
        favBtn=document.createElement('button');
        favBtn.className='spot-fав'; favBtn.setAttribute('data-spot-fav','');
        favBtn.innerHTML='В избранное <span class="heart">❤</span>';
        body.appendChild(favBtn);
      }
      favBtn.dataset.id = String(item.id);
      favBtn.onclick = () => toggleFav(String(item.id));

      body.querySelector('.spot-cta').textContent = I18N[getLang()].card_btn;
      refreshFavButtons();
    }

    function renderAds(items, replace=false){
      const wrap=document.getElementById('ads');
      const empty=document.getElementById('ads-empty');
      if(replace) wrap.innerHTML='';
      if(!Array.isArray(items)||!items.length){ if(!wrap.children.length) empty.hidden=false; return; }
      empty.hidden=true;

      items.forEach(ad=>{
        const id=String(ad.id);
        const title=escapeHtml(ad.title||'—');
        const price=fmtPrice(ad.price, ad.price_text);
        const district=escapeHtml(ad.district || I18N[getLang()].card_no_district);
        const photos=getPhotos(ad.photos);
        const img=photos[0];

        const el=document.createElement('article');
        el.className='ad-card';
        el.innerHTML=`
          <div class="ad-thumb">
            ${img && !isDefaultPic(img) ? `<img src="${img}" alt="${title}">` : placeholderHtml()}
          </div>
          <div class="ad-body">
            <h3 class="ad-title">${title}</h3>
            <div class="ad-price">${price}</div>
            <div class="ad-meta">📍 ${district}</div>
            <a class="ad-cta" href="${BOT_LINK}" target="_blank" rel="noopener">${I18N[getLang()].card_btn}</a>
            ${favButtonHtml(id)}
          </div>`;
        wrap.appendChild(el);
      });

      document.querySelectorAll('[data-fav]').forEach(btn=>{
        btn.onclick = () => toggleFav(btn.getAttribute('data-fav'));
      });
      refreshFavButtons();
    }

    /* ====== Локальные объявления из post.html (на случай офлайна) ====== */
    function getUserListings(){
      try{ return JSON.parse(localStorage.getItem('user_listings')||'[]'); }
      catch{ return []; }
    }

    async function initialLoad(){
      try{
        const items = await fetchPage(0);
        allItems = items.slice();
        listFrom = items.length;

        const local = getUserListings();
        if(items.length) renderSpot(items[0]);
        else if(local.length) renderSpot(local[0]);

        if(local.length) renderAds(local, true);
        renderAds(items, !local.length);
      }catch(e){
        const local = getUserListings();
        if(local.length){
          renderSpot(local[0]);
          renderAds(local, true);
        }else{
          console.warn('Не удалось загрузить объявления:', e);
        }
      }
    }

    async function loadMore(){
      try{
        const more=await fetchPage(listFrom);
        if(!more.length) return;
        allItems=allItems.concat(more);
        listFrom+=more.length;
        renderAds(more,false);
      }catch(e){ console.warn('Не удалось подгрузить ещё:',e); }
    }

    document.getElementById('loadMore').addEventListener('click', loadMore);

    document.addEventListener('DOMContentLoaded', ()=>{
      setLang(getLang());
      initialLoad();
      setInterval(async ()=>{
        try{
          const fresh=await fetchPage(0);
          if(fresh.length && (!allItems.length || fresh[0].id!==allItems[0].id)){
            allItems=fresh.slice(); listFrom=fresh.length;

            const local = getUserListings();
            if(fresh.length) renderSpot(fresh[0]);
            else if(local.length) renderSpot(local[0]);

            if(local.length) renderAds(local, true);
            renderAds(fresh, !local.length);
          }
        }catch(_){}
      }, POLL_MS);
    });
  </script>
</body>
</html>
