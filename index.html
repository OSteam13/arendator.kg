<!doctype html>
<html lang="ru" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Arendator.kg — Найди жильё сегодня</title>
  <meta name="description" content="Свежие объявления от владельцев. Анти‑агент. Телефоны по подписке 300/600 сом. Быстрый поиск, карта и мгновенные уведомления." />
  <link rel="icon" href="./images/Arendatorkg.png">
  <link href="https://fonts.googleapis.com/css2?family=Onest:wght@400;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ["Onest", "system-ui", "-apple-system", "Segoe UI", "Roboto", "Arial", "sans-serif"] },
          boxShadow: {
            soft: "0 10px 30px rgba(0,0,0,.08)",
          },
          colors: {
            brand: {
              50: '#eefcf6', 100:'#d6faea', 200:'#aef3d6', 300:'#7ce8bf', 400:'#49dba6',
              500:'#16c68a', 600:'#0ea371', 700:'#0c845e', 800:'#0b6b4f', 900:'#064233'
            }
          }
        }
      }
    }
  </script>
  <style>
    html,body{font-family:Onest,system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif}
    .container{max-width:1180px}
    .pill{backdrop-filter:saturate(1.3) blur(8px)}
    .glass{backdrop-filter:blur(10px)}
    .mask-blur{filter:blur(3px)}
    .cut{clip-path:polygon(0 0,100% 0,100% 90%,0 100%)}
  </style>
</head>
<body class="bg-neutral-25 text-neutral-900">
  <!-- Top bar -->
  <div class="bg-brand-600 text-white text-center text-xs sm:text-sm py-2">
    Только владельцы • Анти‑агент • Жизнь объявления 24ч • Нет автопродлений
  </div>

  <!-- NEW HEADER: Minimal + search pill centered -->
  <header class="relative">
    <div class="absolute inset-0 -z-10 bg-gradient-to-b from-brand-50 to-white"></div>

    <div class="container mx-auto px-4 py-4 flex items-center justify-between">
      <a href="#" class="flex items-center gap-2">
        <img src="./images/Arendatorkg.png" alt="Arendator.kg" class="w-8 h-8 rounded-full object-contain">
        <span class="font-extrabold">Arendator.kg</span>
      </a>

      <nav class="hidden md:flex items-center gap-6 text-sm text-neutral-700">
        <a href="#feed" class="hover:text-brand-700">Лента</a>
        <a href="#map" class="hover:text-brand-700">Карта</a>
        <a href="#pricing" class="hover:text-brand-700">Тарифы</a>
        <a href="#tips" class="hover:text-brand-700">Безопасность</a>
      </nav>

      <div class="flex items-center gap-2">
        <button id="lang" class="px-2 py-1 rounded-lg border border-neutral-200 text-sm">Рус / Кыр</button>
        <button id="btnLogin" class="px-3 py-1.5 rounded-lg bg-neutral-900 text-white text-sm">Войти</button>
      </div>
    </div>

    <!-- Centered search pill -->
    <div class="container mx-auto px-4 pb-8">
      <div class="pill mx-auto w-full md:w-[860px] rounded-2xl bg-white/80 shadow-soft border border-white/60">
        <div class="flex flex-col md:flex-row gap-3 md:gap-0 items-stretch">
          <div class="flex-1 grid grid-cols-2 md:grid-cols-4 gap-3 p-3">
            <select id="tType" class="px-3 py-3 rounded-xl border border-neutral-200 bg-white/70">
              <option>Снять</option><option>Сдать</option>
            </select>
            <select id="tKind" class="px-3 py-3 rounded-xl border border-neutral-200 bg-white/70">
              <option>Квартира</option><option>Комната</option><option>Дом</option>
            </select>
            <select id="tCity" class="px-3 py-3 rounded-xl border border-neutral-200 bg-white/70">
              <option>Бишкек</option><option>Ош</option><option>Ыссык‑Куль</option>
            </select>
            <select id="tDistrict" class="px-3 py-3 rounded-xl border border-neutral-200 bg-white/70">
              <option>Любой район</option><option>Центр</option><option>Московский</option>
            </select>
          </div>
          <div class="flex items-center gap-3 px-3 pb-3 md:pb-0">
            <input id="priceFrom" type="number" inputmode="numeric" placeholder="Цена от" class="px-3 py-3 rounded-xl border border-neutral-200 w-36">
            <input id="priceTo" type="number" inputmode="numeric" placeholder="до" class="px-3 py-3 rounded-xl border border-neutral-200 w-28">
            <button id="btnSearch" class="px-4 py-3 rounded-xl bg-brand-600 hover:bg-brand-700 text-white font-semibold whitespace-nowrap">Искать</button>
          </div>
        </div>
        <div class="px-4 py-2 flex flex-wrap gap-3 text-xs text-neutral-600">
          <label class="inline-flex items-center gap-2"><input id="fOwner" type="checkbox"> от владельца</label>
          <label class="inline-flex items-center gap-2"><input id="fDaily" type="checkbox"> посуточно</label>
          <label class="inline-flex items-center gap-2"><input id="fNew" type="checkbox"> только новые (≤3ч)</label>
          <label class="inline-flex items-center gap-2"><input id="fVerified" type="checkbox"> проверенные</label>
          <div class="ml-auto flex items-center gap-2">
            <span class="hidden sm:inline">Сортировка:</span>
            <select id="sort" class="px-2 py-1 rounded-lg border border-neutral-200">
              <option value="fresh">сначала свежие</option>
              <option value="cheap">сначала дешёвые</option>
              <option value="exp">сначала дорогие</option>
            </select>
          </div>
        </div>
      </div>

      <div class="mt-6 text-center">
        <h1 class="text-3xl md:text-5xl font-extrabold tracking-tight">Найди жильё сегодня, без посредников</h1>
        <p class="mt-2 text-neutral-600">Ежесекундное обновление из 30 источников • Анти‑агент • Мгновенные уведомления</p>
      </div>
    </div>
  </header>

  <!-- SECTION: tabs Feed / Map / Saved -->
  <section id="feed" class="container mx-auto px-4">
    <div class="sticky top-16 z-20 -mx-4 px-4 bg-gradient-to-b from-white/90 to-white/60 backdrop-blur py-3 border-b border-neutral-100">
      <div class="flex items-center gap-2">
        <button data-tab="list" class="tabBtn px-3 py-2 rounded-lg bg-neutral-900 text-white text-sm">Лента</button>
        <button data-tab="map" class="tabBtn px-3 py-2 rounded-lg border border-neutral-200 text-sm">Карта</button>
        <button data-tab="saved" class="tabBtn px-3 py-2 rounded-lg border border-neutral-200 text-sm">Сохранённые</button>
        <div class="ml-auto text-xs text-neutral-600" id="meta">Загружаем…</div>
      </div>
    </div>

    <!-- List tab -->
    <div id="tab-list" class="pt-4 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"></div>

    <!-- Map tab (placeholder, ready for real map) -->
    <div id="tab-map" class="hidden pt-4">
      <div class="rounded-2xl border border-neutral-200 overflow-hidden shadow-soft">
        <div class="aspect-[16/9] bg-[url('https://tile.openstreetmap.org/9/290/145.png')] bg-cover grid place-items-center text-neutral-600">
          Карта (интегрируй Leaflet / Mapbox)
        </div>
      </div>
    </div>

    <!-- Saved tab -->
    <div id="tab-saved" class="hidden pt-4">
      <div class="rounded-2xl border border-neutral-200 p-6 text-neutral-600">
        Здесь появятся ваши избранные и сохранённые поиски.
      </div>
    </div>

    <div class="flex justify-center py-8">
      <button id="btnMore" class="px-4 py-2 rounded-xl border border-neutral-200 bg-white hover:bg-neutral-50">Показать ещё</button>
    </div>
  </section>

  <!-- SECTION: pricing ribbon full-bleed -->
  <section id="pricing" class="mt-4">
    <div class="bg-gradient-to-r from-brand-600 to-brand-700 text-white">
      <div class="container mx-auto px-4 py-10 grid md:grid-cols-2 gap-6 items-stretch">
        <div class="rounded-2xl bg-white/10 p-6 shadow-soft">
          <div class="text-xl font-bold">300 сом <span class="font-normal text-white/80">неделя</span></div>
          <ul class="mt-3 space-y-1 text-sm text-white/90">
            <li>• Телефоны владельцев без лимита</li>
            <li>• Анти‑агент фильтр</li>
            <li>• Уведомления о новых совпадениях</li>
            <li>• Ежесекундное обновление из 30 источников</li>
          </ul>
          <button class="pay mt-4 px-4 py-2 rounded-xl bg-white text-brand-700 font-semibold">Открыть номера владельцев</button>
          <div class="text-xs text-white/80 mt-2">Если доступ не открылся сразу — решим в чате или продлим время.</div>
        </div>
        <div class="relative rounded-2xl bg-white text-neutral-900 p-6 shadow-soft">
          <span class="absolute -top-3 right-4 px-2 py-1 rounded-full bg-amber-100 text-amber-800 text-xs">Популярно</span>
          <div class="text-xl font-bold">600 сом <span class="font-normal text-neutral-500">месяц</span></div>
          <ul class="mt-3 space-y-1 text-sm text-neutral-800">
            <li>• Всё из недельного тарифа</li>
            <li>• Приоритетная поддержка</li>
            <li>• 2 устройства одновременно</li>
            <li>• Бонус: сохранённые поиски</li>
          </ul>
          <button class="pay mt-4 px-4 py-2 rounded-xl bg-brand-600 hover:bg-brand-700 text-white font-semibold">Открыть номера владельцев</button>
          <div class="text-xs text-neutral-500 mt-2">Автопродлений нет. Продление — вручную.</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Safety tips -->
  <section id="tips" class="container mx-auto px-4 py-10">
    <div class="rounded-2xl border border-amber-200 bg-amber-50 p-5">
      <div class="font-semibold mb-2">Безопасность аренды</div>
      <ul class="text-sm text-amber-900 space-y-1">
        <li>• Не переводите предоплату до просмотра и договора.</li>
        <li>• Проверяйте документы и право собственности.</li>
        <li>• Подозрительно дёшево? Может быть фейк. Сообщите в поддержку.</li>
      </ul>
    </div>
  </section>

  <!-- Footer -->
  <footer class="border-t border-neutral-100 bg-white">
    <div class="container mx-auto px-4 py-8 grid md:grid-cols-4 gap-6 text-sm">
      <div class="md:col-span-2">
        <div class="flex items-center gap-2">
          <img src="./images/Arendatorkg.png" alt="Arendator.kg" class="w-7 h-7 rounded-full object-contain">
          <span class="font-semibold">Arendator.kg</span>
        </div>
        <p class="text-neutral-600 mt-2 max-w-[60ch]">Собираем и фильтруем только свежие объявления от владельцев, чтобы вы нашли жильё быстрее и без переплат посредникам.</p>
      </div>
      <div>
        <div class="font-semibold">Навигация</div>
        <ul class="mt-2 space-y-1 text-neutral-600">
          <li><a href="#feed" class="hover:text-brand-700">Лента</a></li>
          <li><a href="#map" class="hover:text-brand-700">Карта</a></li>
          <li><a href="#pricing" class="hover:text-brand-700">Тарифы</a></li>
        </ul>
      </div>
      <div>
        <div class="font-semibold">Правовое</div>
        <ul class="mt-2 space-y-1 text-neutral-600">
          <li><a class="hover:text-brand-700" href="#">Пользовательское соглашение</a></li>
          <li><a class="hover:text-brand-700" href="#">Политика конфиденциальности</a></li>
        </ul>
      </div>
    </div>
    <div class="text-center text-xs text-neutral-500 pb-6">© 2025 — Arendator.kg</div>
  </footer>

  <!-- Floating Best pick bar -->
  <div id="bestBar" class="fixed bottom-4 left-1/2 -translate-x-1/2 w-[min(920px,92vw)] hidden md:flex items-center gap-3 bg-white/90 border border-neutral-200 rounded-2xl shadow-soft p-2 glass">
    <img id="bestImg" class="w-20 h-14 rounded-xl object-cover bg-neutral-100" alt="Лучшее" />
    <div class="flex-1 min-w-0">
      <div class="truncate font-semibold" id="bestTitle">—</div>
      <div class="text-sm text-neutral-600"><span id="bestMetaPlace">—</span> • <span id="bestPrice">—</span></div>
    </div>
    <button id="bestCall" class="px-3 py-2 rounded-xl bg-brand-600 hover:bg-brand-700 text-white text-sm">Позвонить · <span id="bestMasked">+996 ••• •• •••</span></button>
  </div>

  <!-- Toast -->
  <div id="toast" class="fixed bottom-4 left-1/2 -translate-x-1/2 hidden px-4 py-2 rounded-xl bg-neutral-900 text-white text-sm"></div>

  <script>
    // ===== Demo data (тот же формат, что и у тебя, + createdAt) =====
    const listings = [
      { id:'l1', title:'2к, Центр, свежий ремонт', price:35000, district:'Центр', rooms:'2', daily:false, owner:true, verified:true, img:'', phone:'+996555123456', expiresAt: Date.now()+23*3600e3+30*60e3, createdAt: Date.now()-2*3600e3 },
      { id:'l2', title:'1к, Майевка, уютная',      price:18000, district:'Майевка', rooms:'1', daily:false, owner:true, verified:true, img:'https://images.unsplash.com/photo-1502005229762-cf1b2da7cda7?q=80&w=1200&auto=format&fit=crop', phone:'+996700222333', expiresAt: Date.now()+10*3600e3, createdAt: Date.now()-1*3600e3 },
      { id:'l3', title:'3к, Асанбай, вид на горы', price:55000, district:'Асанбай', rooms:'3+',daily:false, owner:false, verified:false,img:'https://images.unsplash.com/photo-1560066984-138dadb4c035?q=80&w=1200&auto=format&fit=crop', phone:'+996777444555', expiresAt: Date.now()+6*3600e3, createdAt: Date.now()-7*3600e3 },
      { id:'l4', title:'Студия, Московский',       price:22000, district:'Московский',rooms:'1', daily:false, owner:true, verified:true, img:'https://images.unsplash.com/photo-1493809842364-78817add7ffb?q=80&w=1200&auto=format&fit=crop', phone:'+996555987654', expiresAt: Date.now()+12*3600e3, createdAt: Date.now()-50*60*1000 },
      { id:'l5', title:'Посуточно 2к, Центр',      price:3000,  district:'Центр', rooms:'2', daily:true,  owner:true, verified:true, img:'https://images.unsplash.com/photo-1502823403499-6ccfcf4fb453?q=80&w=1200&auto=format&fit=crop', phone:'+996709111222', expiresAt: Date.now()+20*3600e3, createdAt: Date.now()-30*60*1000 },
      { id:'l6', title:'3к, Свердловский, новая мебель', price:45000, district:'Свердловский', rooms:'3+', daily:false, owner:true, verified:false, img:'https://images.unsplash.com/photo-1494526585095-c41746248156?q=80&w=1200&auto=format&fit=crop', phone:'+996500321654', expiresAt: Date.now()+5*3600e3, createdAt: Date.now()-10*3600e3 },
    ];

    // ===== Utils =====
    const qs  = (s,el=document)=>el.querySelector(s);
    const qsa = (s,el=document)=>Array.from(el.querySelectorAll(s));
    const showToast=(m)=>{const t=qs('#toast'); t.textContent=m; t.classList.remove('hidden'); clearTimeout(showToast.t); showToast.t=setTimeout(()=>t.classList.add('hidden'),2200);} ;
    const maskPhone=(p)=> p ? p.replace(/(\+\d{3})\d+/, '$1 ••• •• •••') : '•••';
    const hasAccess=()=>Date.now() < Number(localStorage.getItem('accessUntil')||0);
    const setAccess=(h=24)=>{ localStorage.setItem('accessUntil', String(Date.now()+h*3600e3)); showToast('Доступ открыт на 24 часа'); };
    const timeAgo = (ms)=>{ const d = Date.now()-ms; const m = Math.floor(d/60000); if (m<1) return 'только что'; if (m<60) return m+' мин назад'; const h=Math.floor(m/60); return h+' ч назад'; };

    // ===== Tabs =====
    qsa('.tabBtn').forEach(btn=>btn.addEventListener('click',()=>{
      qsa('.tabBtn').forEach(b=>b.classList.remove('bg-neutral-900','text-white'));
      btn.classList.add('bg-neutral-900','text-white');
      const tab = btn.dataset.tab;
      qs('#tab-list').classList.toggle('hidden', tab!=='list');
      qs('#tab-map').classList.toggle('hidden', tab!=='map');
      qs('#tab-saved').classList.toggle('hidden', tab!=='saved');
    }));

    // ===== Best pick floating bar =====
    function mountBest(){
      const best = listings.find(it=>!it.daily && it.price<=25000) || listings[0];
      if (!best) return;
      qs('#bestBar').classList.remove('hidden');
      qs('#bestImg').src = best.img || 'https://images.unsplash.com/photo-1493809842364-78817add7ffb?q=80&w=1200&auto=format&fit=crop';
      qs('#bestTitle').textContent = best.title;
      qs('#bestMetaPlace').textContent = `${best.district} · Комнат: ${best.rooms}`;
      qs('#bestPrice').textContent = (best.price||0).toLocaleString('ru-RU') + (best.daily?' сом/сут':' сом/мес');
      qs('#bestMasked').textContent = maskPhone(best.phone);
      qs('#bestCall').onclick = ()=>{
        if(!localStorage.getItem('userLogged')){ showToast('Войдите, чтобы звонить'); return; }
        if(!hasAccess()){ openPay(); return; }
        location.href = `tel:${best.phone}`;
      }
    }

    // ===== Cards =====
    function cardHTML(it){
      const unit = it.daily? 'сом/сут':'сом/мес';
      const favs = new Set(JSON.parse(localStorage.getItem('favs')||'[]'));
      const isFav = favs.has(it.id);
      const isNew = (Date.now()-it.createdAt) < 3*3600e3;
      return `
      <article class="group rounded-2xl border border-neutral-200 bg-white overflow-hidden shadow-sm hover:shadow-md transition-shadow flex flex-col h-full">
        <div class="relative aspect-[4/3] overflow-hidden bg-neutral-100">
          ${it.img?`<img src="${it.img}" alt="${it.title}" class="w-full h-full object-cover group-hover:scale-105 transition-transform">`:`<div class='w-full h-full'></div>`}
          <div class="absolute top-2 left-2 flex flex-wrap gap-2 text-[10px]">
            ${it.owner?'<span class="px-2 py-1 rounded-full bg-emerald-100 text-emerald-700">Без посредников</span>':'<span class="px-2 py-1 rounded-full bg-neutral-100 text-neutral-700">Источник</span>'}
            ${it.verified?'<span class="px-2 py-1 rounded-full bg-emerald-100 text-emerald-700">Проверено</span>':''}
            ${isNew?'<span class="px-2 py-1 rounded-full bg-blue-100 text-blue-700">Новое</span>':''}
          </div>
        </div>
        <div class="p-4 flex-1 flex flex-col gap-3">
          <h3 class="font-semibold leading-snug line-clamp-2">${it.title}</h3>
          <div class="flex items-center gap-2">
            <div class="text-2xl font-bold">${it.price.toLocaleString('ru-RU')} <span class="text-sm font-medium text-neutral-500">${unit}</span></div>
            <div class="ml-auto text-xs text-neutral-600" title="когда добавлено">${timeAgo(it.createdAt)}</div>
          </div>
          <div class="flex items-center gap-2 text-sm text-neutral-600">
            <div>${it.district}</div><div>·</div><div>Комнат: ${it.rooms}</div>
          </div>
          <div class="mt-auto flex items-center gap-2">
            <input readonly class="flex-1 px-3 py-2 rounded-xl border border-neutral-200 bg-neutral-50 ${hasAccess()?'':'mask-blur'}" value="${it.phone}">
            <button class="px-3 py-2 rounded-xl bg-brand-600 hover:bg-brand-700 text-white text-sm reveal" data-id="${it.id}">${hasAccess()?'Скопировать':'Показать номер'}</button>
            <button class="px-3 py-2 rounded-xl border border-neutral-200 text-sm fav" data-id="${it.id}" title="В избранное">${isFav?'❤':'♡'}</button>
          </div>
        </div>
      </article>`
    }

    function renderList(data){
      const grid=qs('#tab-list'); grid.innerHTML='';
      if(!data.length){ grid.innerHTML='<div class="col-span-full text-center text-neutral-600 py-12">Нет объявлений по фильтрам</div>'; return; }
      data.forEach(it=>grid.insertAdjacentHTML('beforeend', cardHTML(it)));
      qsa('.reveal', grid).forEach(b=>b.addEventListener('click', onReveal));
      qsa('.fav', grid).forEach(b=>b.addEventListener('click', onFav));
      qs('#meta').textContent = `Показано ${data.length} объявлений`;
    }

    function filters(){
      return {
        min: Number(qs('#priceFrom').value||0),
        max: Number(qs('#priceTo').value||Infinity),
        owner: qs('#fOwner').checked,
        daily: qs('#fDaily').checked,
        onlyNew: qs('#fNew').checked,
        verified: qs('#fVerified').checked,
        sort: qs('#sort').value
      }
    }

    function apply(){
      const f = filters();
      let out = listings.filter(it=> (
        it.price>=f.min && it.price<=f.max && (!f.owner || it.owner) && (!f.daily || it.daily) && (!f.onlyNew || (Date.now()-it.createdAt)<=3*3600e3) && (!f.verified || it.verified)
      ));
      if (f.sort==='cheap') out.sort((a,b)=>a.price-b.price); else if (f.sort==='exp') out.sort((a,b)=>b.price-a.price); else out.sort((a,b)=>b.createdAt-a.createdAt);
      renderList(out);
    }

    function onReveal(e){
      if(!localStorage.getItem('userLogged')){ showToast('Войдите, чтобы видеть телефоны'); return; }
      if(!hasAccess()){ openPay(); return; }
      const input=e.currentTarget.parentElement.querySelector('input');
      navigator.clipboard.writeText(input.value).then(()=>showToast('Номер скопирован'));
    }

    function onFav(e){
      if(!localStorage.getItem('userLogged')){ showToast('Войдите, чтобы сохранять'); return; }
      const id=e.currentTarget.dataset.id;
      const favs=new Set(JSON.parse(localStorage.getItem('favs')||'[]'));
      if(favs.has(id)){favs.delete(id); e.currentTarget.textContent='♡'; showToast('Убрано из избранного');}
      else{favs.add(id); e.currentTarget.textContent='❤'; showToast('Добавлено в избранное');}
      localStorage.setItem('favs', JSON.stringify([...favs]));
    }

    // ===== Pay modal (very small demo) =====
    const payModal = document.createElement('div');
    payModal.className = 'fixed inset-0 hidden items-center justify-center bg-black/40 p-4';
    payModal.innerHTML = `
      <div class="w-full max-w-md rounded-2xl bg-white p-6 shadow-soft">
        <div class="text-lg font-semibold">Открой номера владельцев</div>
        <p class="text-sm text-neutral-600 mt-1">После оплаты доступ активируется автоматически. Никаких автопродлений.</p>
        <div class="mt-4 grid grid-cols-3 gap-2 text-sm">
          <button class="pm px-3 py-2 rounded-xl border border-neutral-200 hover:bg-neutral-50" data-method="mbank">MBank QR</button>
          <button class="pm px-3 py-2 rounded-xl border border-neutral-200 hover:bg-neutral-50" data-method="elqr">ELQR</button>
          <button class="pm px-3 py-2 rounded-xl border border-neutral-200 hover:bg-neutral-50" data-method="card">Карта</button>
        </div>
        <div id="pick" class="mt-3 text-sm text-neutral-700 hidden">Вы выбрали: <span class="font-medium" id="pmName"></span></div>
        <div class="mt-4 grid grid-cols-2 gap-2">
          <button id="payGo" class="px-4 py-2 rounded-xl bg-brand-600 text-white">Оплата прошла (демо)</button>
          <button id="payClose" class="px-4 py-2 rounded-xl border border-neutral-200">Отмена</button>
        </div>
      </div>`;
    document.body.appendChild(payModal);

    function openPay(){ payModal.classList.remove('hidden'); payModal.classList.add('flex'); }
    function closePay(){ payModal.classList.add('hidden'); payModal.classList.remove('flex'); }

    document.addEventListener('click', (e)=>{
      if(e.target.classList?.contains('pay')) openPay();
      if(e.target.id==='payClose') closePay();
      if(e.target.classList?.contains('pm')){ qs('#pick').classList.remove('hidden'); qs('#pmName').textContent=e.target.textContent; }
      if(e.target.id==='payGo'){ setAccess(24); closePay(); }
    });

    // ===== Login demo =====
    document.getElementById('btnLogin').addEventListener('click', ()=>{
      localStorage.setItem('userLogged','1'); showToast('Вход выполнен (демо)');
    });

    // ===== Bind search
    document.getElementById('btnSearch').addEventListener('click', apply);
    qsa('#fOwner,#fDaily,#fNew,#fVerified,#sort').forEach(el=>el.addEventListener('change', apply));

    // ===== Start
    document.addEventListener('DOMContentLoaded', ()=>{ apply(); mountBest(); });

    // Load more (demo clones)
    document.getElementById('btnMore').addEventListener('click', ()=>{
      const more = listings.map(x=>({ ...x, id: x.id+Math.random().toString(36).slice(2,6), createdAt: Date.now()-Math.floor(Math.random()*6)*3600e3 }));
      listings.push(...more.slice(0,6));
      apply();
    });
  </script>
</body>
</html>
