<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Arendator.kg — свежие квартиры без посредников</title>
  <meta name="description" content="Свежие объявления аренды от владельцев. Анти-агент фильтр, номера открываются после оплаты. Объявления живут 24 часа." />
  <link rel="icon" href="./images/Arendatorkg.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{--container:1180px; --ads:110px}
    .container{max-width:var(--container)}
    .shadow-soft{box-shadow:0 8px 30px rgba(0,0,0,.08)}
    html,body{overflow-x:hidden}
    .side-ads{position:fixed;top:60px;bottom:0;width:var(--ads);display:flex;align-items:center;justify-content:center;pointer-events:none;z-index:10}
    .side-ads>div{writing-mode:vertical-rl;transform:rotate(180deg);opacity:.75}
    @media (max-width:1400px){.side-ads{display:none}}
    .card-actions{display:flex;gap:.5rem;align-items:center}
    .card-actions>input{min-width:0}
    .mask-blur{filter:blur(3px)}
  </style>
</head>
<body class="bg-neutral-50 text-neutral-900">

  <!-- Хедер -->
  <header class="bg-white sticky top-0 z-40 border-b border-neutral-100/80">
    <div class="container mx-auto px-4 py-3 flex items-center gap-3">
      <a href="/" class="flex items-center gap-2 shrink-0">
        <img src="./images/Arendatorkg.png" alt="Arendator.kg" class="w-8 h-8 rounded-full object-contain">
      </a>
      <nav class="ml-2 flex items-center gap-5 text-sm">
        <a href="post.html" class="px-3 py-1.5 rounded-xl bg-neutral-900 text-white hover:bg-neutral-800">Добавить объявление</a>
        <a href="#sell" class="hover:text-blue-600">Продажа</a>
        <a href="blog.html" class="hover:text-blue-600">Блог</a>
        <button id="navFav" class="hover:text-blue-600">Избранное</button>
      </nav>
      <div class="ml-auto flex items-center gap-4 text-sm">
        <button id="btnAuth" class="text-blue-600 hover:underline">Вход / регистрация</button>
      </div>
    </div>
  </header>

  <!-- Модалка логина -->
  <div id="modalLogin" class="fixed inset-0 hidden items-center justify-center bg-black/40 p-4">
    <div class="w-full max-w-md rounded-2xl bg-white p-6 shadow-soft">
      <div class="text-lg font-semibold">Вход</div>
      <p class="text-sm text-neutral-600 mt-1">Быстрее и надёжнее всего — через Telegram.</p>

      <!-- Кнопка Telegram -->
      <div id="tgLoginContainer" class="mt-4 flex justify-center"></div>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="fixed bottom-4 left-1/2 -translate-x-1/2 hidden px-4 py-2 rounded-xl bg-neutral-900 text-white text-sm"></div>

  <script>
    const qs=(s,el=document)=>el.querySelector(s);
    const qsa=(s,el=document)=>Array.from(el.querySelectorAll(s));
    const showToast=(m)=>{const t=qs('#toast'); t.textContent=m; t.classList.remove('hidden'); clearTimeout(showToast.t); showToast.t=setTimeout(()=>t.classList.add('hidden'),2200);};

    const modalLogin=qs('#modalLogin');
    function openLogin(){ modalLogin.classList.remove('hidden'); modalLogin.classList.add('flex'); }
    function closeLogin(){ modalLogin.classList.add('hidden'); modalLogin.classList.remove('flex'); }

    qs('#btnAuth').addEventListener('click', openLogin);

    // Динамически вставляем Telegram Widget
    function mountTelegramWidget(){
      if (qs('#tgLoginContainer script')) return;
      const s=document.createElement('script');
      s.src="https://telegram.org/js/telegram-widget.js?22";
      s.setAttribute('data-telegram-login','ArendatorKGbot'); // имя твоего бота
      s.setAttribute('data-size','large');
      s.setAttribute('data-userpic','false');
      s.setAttribute('data-request-access','write');
      s.setAttribute('data-onauth','onTelegramAuth(user)');
      qs('#tgLoginContainer').appendChild(s);
    }
    mountTelegramWidget();

    // Обработчик авторизации
    window.onTelegramAuth = async function(user){
      try {
        localStorage.setItem('userLogged','1');
        localStorage.setItem('tg_user',JSON.stringify(user));
        closeLogin();
        showToast('Вход через Telegram выполнен');
      } catch(e){
        alert('Ошибка авторизации: '+e.message);
      }
    };
  </script>
</body>
</html>
